name: .NET Framework CI

on:
 push:
   branches:
     - main
     - staging
     - dev
 pull_request:
   branches:
     - main
     - staging
     - dev

jobs:
 build:

   runs-on: windows-latest

   steps:
   - name: Checkout code
     uses: actions/checkout@v4

   - name: Setup .NET Framework
     uses: actions/setup-dotnet@v4
     with:
       dotnet-version: '4.8.1'
       cache: true

   - name: Restore dependencies
     run: nuget restore

   - name: Build solution
     run: dotnet build --configuration Release

   - name: Run tests
     run: dotnet test --configuration Release --no-build --logger "trx;LogFileName=test_results.trx"

   - name: Publish test results
     if: always()
     uses: actions/upload-artifact@v4
     with:
       name: Test Results
       path: test_results.trx